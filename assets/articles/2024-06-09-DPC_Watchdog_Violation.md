# DPC Watchdog Violation
computer_bugs

Three or four years ago, one encountered some problems with one's computer. As long as one connected the speaker port (green circle), the computer might jammed and cause DPC Watchdog Violation bluescreen. Of course, one usually don't wait until it goes bluescreen, restart immediately when it jammed. It usually jammed when one plays video, esp. YouTube. For some problem, YouTube seems to be too graphic-intensive that one's computer were having issue rendering it smoothly. Sometimes, we see some checkerboard problems. Other times, the whole screen blackout, and repair where you move your mouse to. The problem started out very sparsely, perhaps twice per week. As time passes, it had reached once every day. The suffering persisted until one downloaded Obsidian markdown writer. 

The largest problem with Obsidian is it saves every few words you type. People even complaint that your hard disk life is reduced significantly due to the incessant saving behavior. It also means that, when your computer jams, it'll save the corrupted files to your Obsidian workspace. At that time, one don't know that Obsidian had a built-in recovery function (one only found this very recently when browsing the settings section), so one implements one's own backup function that saves every hour. Well, one time, at the 58th minutes, it crashed, so what had been done for the past 58 minutes, short of 2 minutes to the next backup, were lost. Ouch! That's when one set out to solve the problem. 

Searching online, there was a lot of solution, like replacing some SATA AHCI driver. Ok, when one check one's manufacturer, there wasn't a program for replacing that. Intel's website do have the program, but they strongly discourage you doing it unless you know what you're doing; if not, you risk making your system less stable. Of course, worse come to worse, we can try, but at that time, it's not yet the time. 

The first solution one used is to plug off the speaker. It makes sense, because in the past few years, when one don't use external speakers that connect to the green circle button, it'll not have the error. Of course, later on, the problem got so bad even without the speaker one had the problem, so that we'll explore later. For now, whenever one want to type on Obsidian, one'll need to plug off the speaker. And of couse, you just need to disconnect the speaker, and one disconnect the USB instead of the green plug because one can connect the USB to one's monitor, while the green plug, one need to walk a few steps to the back where one's mainframe was. That takes more time, so connect and disconnect USB is more easier. 

That does solve for a while, but later when problems got worse, the root still don't solve. So, one set out to debug the problem, and one saw Windows have a "minidump" for every bluescreen (if you wait for it to bluescreen than force restart your PC when it jams). Now, without the speaker keeps beeping when it jams (if you're playing a song, it'll go 'beeeeeeeppppppp' unlimited time until your computer restart or blue screen) (we disconnect the speaker, so now it don't necessarily jams when you listen to a song, one encounters jam now when typing without any background music), one can wait for the computer to go bluescreen and get the minidump. Then, with WinDbg program, one can see what problem causes the error. 

WinDbg is easy to use, at least, the easy version of WinDbg is easy to use. Basically, ignore all the memory hexes that are human-unreadable, and focus on clicking the buttons that says "start debugging", choose a file (make sure to move your file to another folder like the download folder first, otherwise you won't have permission to run, unless WinDbg found there's a recent file and ask you to "Debug Now"), and it'll have some blue links for you to click that autofill the debug console and print the output you want. Ok, ignore all memory hexes, go directly to the program which cause the crash. The reason is, one don't even know how to debug the memory hexes, and too lazy to learn; one just want quick fixes (in this case)!!! 

MsiAfterburner.exe. Great! That's the one that caused the problem. Let's uninstall MSI AfterBurner. Certainly, after uninstalling, with one's speaker still not in use (one bought an external bluetooth adapter that gives my mainframe bluetooth support, so one can use bluetooth speaker now), it now only crashes once per week! That was a huge improvement. Then, one tries connecting the green circle port speaker, and after a few days, one encounter the problem again. That immediately shocked one not to continue using it. Yet, even without the speaker connected, it continue crashing more frequently again as time passes. 

Let's make some clarification. One said it crashes every week, but one said that connecting the speaker for few days then it crashes, how can one associate it with the speaker? One can't, actually. However, the former was an anecdote; one actually don't wait for a week before one connect back the speaker, so before that, one didn't encounter the crash. And with speakers connected, due to past experience, one _assumes_ the crash is due to the speaker in the future event too, even if it isn't caused by the speaker, but probably a speaker + graphics incompatibility problem; at least that's what one assumes that time. 

Now, that makes for a problem. One get the dump again, and debugging, it says some nvidia program, so one assumes that's caused by Nvidia's driver. Searching online says the same thing, but they added it could be the card that had issues too. Great, one still have others 1080 Ti to replace. After replacing, one also use Nvidia cleanup tool to remove all existing Nvidia driver and replaced them with the newest. Forget about the guide that asks you to install an older version because the newest may not be compatible; and forget about some other guide that asks you to not install Windows 22H2 update; these fixes, while they may work, sound stupid to one. Why would you downgrade than upgrade, unless if Windows install some monitoring program that steal your information secretly, or Intel does so, then you downgrade to one that don't steal your information, right? But of course, we dont usually know the latter unless we are hackers ourselves, experts ourselves, or some experts spreaded the news and we receive it. 

But one got it right. Cleaning up, updating to the latest Nvidia Driver (and using the Game Ready Driver than Studio Driver, since one no longer do Machine Learning Training, only Inferences), plus changing the card, solves the problem. One don't encounter it anymore! Though, the speaker now haunts me that one don't intend to connect it back forever. 

A few weeks later, still no problem, yet one had some job that requires one to use PyTorch inferences. One tries to find some `vmap` function with Pytorch, but it wasn't available! Actually, it wasn't available with the PyTorch one installed 3 years ago, v1.9.0+cu111. But with the newest version, v2.3.0+cu121, or anything v2 onwards, it had no problems. By that time, one don't know PyTorch compiled with CUDA within, so one thought we need to install CUDA and cuDNN separately, and one did install the respective version that worked together. 

Boom! The next day, one encountered a crash again. One expect the CUDA and cuDNN had caused the problem; they might had caused the instability, plus perhaps incompatible with the latest driver version. So, as one searched online trying to downgrade torch to v2.3.0+cu118, because one saw that with Pascal architecture, it's encouraged to use an older version of CUDA than the newest v12, one thought that might work. While searching, one encountered a forum on PyTorch that said they included CUDA and cuDNN together with the package, so one don't need to install them separately, so now, the problem's solved! One just need to uninstall everything one installed, and that's what one did, and swear never to install the newest CUDA and cuDNN again. (Actually, one only installed the one on my windows, but one still had a CUDA v11.0 in my WSL, but let's ignore that as it doesn't interfere with the main system _most_ of the time.)

That finally solve the problem. One hadn't encountered a blue screen since then (about 2 weeks ago). So, that's probably something to do with CUDA, cuDNN, graphic cards, and driver version being too complicated, too complex, too tangled, that some unknown problems came up. 

Though, of course, with such fragility of system, not all problem is solved with the computer, and it'll have more in the future. For example, these few days, one encountered one's computer unexpectedly shut down without a warning, and event viewer dont display any reasoning for such unexpected shutdown. It happens actually for quite a time already, but far less occurrences than the DPC Watchdog Violation error. Because one recently found a trojan horse system xeart.exe when one tries to uninstall CUDA; one don't know how it got there, but it seems to appear in the auto startup, so one check it out. 

Ignoring the virus problem for now, one could say that one anchored and see everything as its cause. That's usual human behavior, if you know what Kahneman and Tversky had researched on. Though, with the fear, one still didn't search for what caused the problem, but one had a few hypothesis. 
1. Power spikes. Nvidia GPU sometimes had power spikes that they didnt solve, and with a smaller barely-enough power supply, it can't handle power spikes, and probably caused the restart. 
2. Overheating. Unfortunately, the CUDA process goes 100% (actually, 90+%) for half a minute or something when one do inferences for a lot of loops that can't be batched (due to different H and W in N,C,H,W dimensions); nevertheless, that makes the GPU heated up to 91Â°C (when one's watching, and probably go higher when one isn't watching, but one didnt profile/record it so one dont know if it has), and that will cause the computer to shutdown. 
3. Similar overheating, but CPU, esp. when you use CPU 100% for more than a few minutes, and its overclocking for too long, can cause shutdown to protect the CPU from exceeding overheating threshold. 

That's it for today! 

[One now offers casual writing service to the public. Check it out!](https://www.fiverr.com/s/D84XrA)